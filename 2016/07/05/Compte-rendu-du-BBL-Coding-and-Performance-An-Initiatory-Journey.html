<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Compte rendu du BBL Coding &amp; Performance, An Initiatory Journey</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="//Ardemius.github.io/themes/ichi/favicon.ico">

    <script type="text/javascript" src="//Ardemius.github.io/themes/ichi/assets/js/vendor/fastclick.js?v=1.0.0"></script>
    <script type="text/javascript" src="//Ardemius.github.io/themes/ichi/assets/js/vendor/modernizr.js?v=1.0.0"></script>


    <link rel="stylesheet" type="text/css" href="//Ardemius.github.io/themes/ichi/assets/css/normalize.css?v=1.0.0" />
    <link rel="stylesheet" type="text/css" href="//Ardemius.github.io/themes/ichi/assets/css/foundation.min.css?v=1.0.0" />
    <!--[if lte IE 8]>
        <link rel="stylesheet" type="text/css" href="//Ardemius.github.io/themes/ichi/assets/css/outdatedBrowser.min.css?v=1.0.0">
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="//Ardemius.github.io/themes/ichi/assets/fonts/foundation-icons/foundation-icons.css?v=1.0.0" />
    <link rel="stylesheet" type="text/css" href="//Ardemius.github.io/themes/ichi/assets/css/styles.css?v=1.0.0" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans:300,700,400|Source+Sans+Pro:300,400,600,700,900,300italic,400italic,600italic,700italic,900italic" />

	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" />
	<link rel="stylesheet" type="text/css" href="//Ardemius.github.io/themes/ichi/assets/css/asciidoctor.css?v=1.0.0" />

    <link rel="canonical" href="https://Ardemius.github.io/2016/07/05/Compte-rendu-du-BBL-Coding-and-Performance-An-Initiatory-Journey.html" />
    
    <meta property="og:site_name" content="Inquiring Javaist" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Compte rendu du BBL Coding &amp; Performance, An Initiatory Journey" />
    <meta property="og:description" content="Présenté par Jean-Philippe BEMPEL (architecte performance chez Ullink) en 12@13 à Softeam, le 05/07/2016. Table of Contents 1) Rules of thumb 2) Algo et complexité 3) Les ordres de grandeur 4) Benchmark 5) Optimisation prématurée Conclusion Ressources..." />
    <meta property="og:url" content="https://Ardemius.github.io/2016/07/05/Compte-rendu-du-BBL-Coding-and-Performance-An-Initiatory-Journey.html" />
    <meta property="article:published_time" content="2016-07-04T22:00:00.000Z" />
    <meta property="article:modified_time" content="2017-03-15T14:35:04.732Z" />
    <meta property="article:tag" content="BBL" />
    <meta property="article:tag" content="performance" />
    <meta property="article:tag" content="quality" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Compte rendu du BBL Coding &amp; Performance, An Initiatory Journey" />
    <meta name="twitter:description" content="Présenté par Jean-Philippe BEMPEL (architecte performance chez Ullink) en 12@13 à Softeam, le 05/07/2016. Table of Contents 1) Rules of thumb 2) Algo et complexité 3) Les ordres de grandeur 4) Benchmark 5) Optimisation prématurée Conclusion Ressources..." />
    <meta name="twitter:url" content="https://Ardemius.github.io/2016/07/05/Compte-rendu-du-BBL-Coding-and-Performance-An-Initiatory-Journey.html" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Inquiring Javaist",
    "author": {
        "@type": "Person",
        "name": "Thomas SCHWENDER",
        "image": "https://avatars3.githubusercontent.com/u/1645190?v=3",
        "url": "undefined/author/undefined",
        "sameAs": null
    },
    "headline": "Compte rendu du BBL Coding &amp; Performance, An Initiatory Journey",
    "url": "https://Ardemius.github.io/2016/07/05/Compte-rendu-du-BBL-Coding-and-Performance-An-Initiatory-Journey.html",
    "datePublished": "2016-07-04T22:00:00.000Z",
    "dateModified": "2017-03-15T14:35:04.732Z",
    "keywords": "BBL,  performance,  quality",
    "description": "Présenté par Jean-Philippe BEMPEL (architecte performance chez Ullink) en 12@13 à Softeam, le 05/07/2016. Table of Contents 1) Rules of thumb 2) Algo et complexité 3) Les ordres de grandeur 4) Benchmark 5) Optimisation prématurée Conclusion Ressources..."
}
    </script>

    <meta name="generator" content="Ghost ?" />
    <link rel="alternate" type="application/rss+xml" title="Inquiring Javaist" href="https://Ardemius.github.io/rss" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
</head>
<body class="post-template tag-BBL tag-performance tag-quality">

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdate" href="http://outdatedbrowser.com/">Update my browser now</a></p>
</div>

<nav class="top-bar hide-for-large-up" data-topbar >
  <ul class="title-area">
    <li class="name">

    </li>
    <li class="home"><a class="fi-home" href="https://Ardemius.github.io"></a></li>
    <li class="toggle-topbar"><a href="#" id="trigger-overlay" class="fi-list"></a></li>
  </ul>

<div class="overlay overlay-scale">
    <button type="button" class="overlay-close">Close</button>
    <nav>
        <ul>
            <li><a href="https://Ardemius.github.io">Home</a></li>
        </ul>
    </nav>
</div>

</nav>

<div class="row">

<div class="small-16 medium-16 large-4 columns right head-area" >

<header class="site-head">
    <div class="vertical">
        <div class="site-head-content inner">
            <ul class="side-nav blog-menu show-for-large-up">
                <li><a class="fi-home" href="https://Ardemius.github.io"></a></li>
                <li><a class="fi-torso" href="https://Ardemius.github.io/about"></a></li>
                <li><a class="fi-mail" href="https://Ardemius.github.io/contact"></a></li>
            </ul>
            <a class="blog-logo" href="https://Ardemius.github.io"><img alt="Inquiring Javaist" src="https://secure.gravatar.com/avatar/849f00ab4e13e0e8febe4135f0d17052" alt="Blog Logo" /></a>
            <h1 class="blog-title">Inquiring Javaist</h1>
            <hr>
            <p class="blog-description">Nothing is better than looking under the hood to understand how things are working.</p>
            <div class="blog-network">
<!--                 <a href="#" class="fi-social-pinterest"></a>
                <a href="#" class="fi-social-linkedin"></a>
                <a href="#" class="fi-social-behance"></a>
                <a href="#" class="fi-social-deviant-art"></a>
                <a href="#" class="fi-social-dribbble"></a>
                <a href="#" class="fi-social-flickr"></a>
                <a href="#" class="fi-social-github"></a>
                <a href="#" class="fi-social-skype"></a>
                <a href="#" class="fi-social-snapchat"></a>
                <a href="#" class="fi-social-steam"></a>
                <a href="#" class="fi-social-xbox"></a>
                <a href="#" class="fi-social-reddit"></a> -->
                  <a href="https://github.com/Ardemius/" class="fi-social-github"></a>
                  <a href="@thomasSCHWENDER" class="fi-social-twitter"></a>
            </div>
        </div>
    </div>
</header>

</div>


<div class="small-16 medium-16 large-12 columns main-column left">
    

<main class="content" role="main">

    <article class="post tag-BBL tag-performance tag-quality">


            <h1 class="post-title">Compte rendu du BBL Coding &amp; Performance, An Initiatory Journey</h1>

            <span class="post-meta label"><time datetime="2016-07-05">05 Jul 2016</time></span>

            <section class="post-content">
                <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Présenté par Jean-Philippe BEMPEL (architecte performance chez Ullink) en 12@13 à Softeam, le 05/07/2016.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/BBL_coding-performance/bbl_coding-perf.jpg" alt="bbl coding perf.jpg">
</div>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_1_rules_of_thumb">1) Rules of thumb</a></li>
<li><a href="#_2_algo_et_complexit">2) Algo et complexité</a></li>
<li><a href="#_3_les_ordres_de_grandeur">3) Les ordres de grandeur</a></li>
<li><a href="#_4_benchmark">4) Benchmark</a></li>
<li><a href="#_5_optimisation_pr_matur_e">5) Optimisation prématurée</a></li>
<li><a href="#_conclusion">Conclusion</a></li>
<li><a href="#_ressources">Ressources</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="_1_rules_of_thumb">1) Rules of thumb</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On commence par un avertissement :</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Attention aux règles empiriques que l&#8217;on applique sans savoir pourquoi, car héritées des "anciens du projet"&#8230;&#8203;<br>
&#8594; Il faut toujours vérifier si elles sont toujours d&#8217;actualité !</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Les <strong>évolutions du JIT</strong> ont remplacé bon nombre de ces anciennes règles.</p>
</div>
<div class="paragraph">
<p>Exemple du <code>toArray</code> pour les collections :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/BBL_coding-performance/bbl_coding-perf_rules-of-thumb.png" alt="bbl coding perf rules of thumb.png">
</div>
<div class="title">Figure 1. rule of thumb sur le toArray des collections</div>
</div>
<div class="paragraph">
<p>Malgré ce qu&#8217;on pourrait croire, entre les solutions 2 et 3, c&#8217;est la 2e la plus rapide.<br>
Les dernières versions de Java permettent maintenant d'éviter l&#8217;initialisation des éléments du tableau à 0 dans ce cas.</p>
</div>
<div class="paragraph">
<p>Jean-Philippe nous rappelle également que le JIT marche beaucoup par <strong>pattern matching</strong> (reconnaissance de patterns de codage).</p>
</div>
<div class="paragraph">
<p>Voir la <a href="http://zeroturnaround.com/wp-content/uploads/2016/05/Java-8-cheat-sheet-by-RebelLabs.png">Cheat Sheet sur les Best Practices Java 8 de RebelLabs</a> pour un exemple de rules of thumb actuelles.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2_algo_et_complexit">2) Algo et complexité</h2>
<div class="sectionbody">
<div class="paragraph">
<p>De nouveau la comparaison entre <code>LinkedList</code> et <code>ArrayList</code>, en \$O(k1 \times n)\$ et \$O(k2 \times n)\$, mais avec <strong>\$k1 &gt; k2\$</strong> du fait du cache de nos processeurs modernes.<br>
Pour ceux qui étaient présents à Devoxx France 2016, Rémi FORAX et José PAUMARD avaient déjà abordé ce sujet.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Morale de l&#8217;histoire : les constantes COMPTENT !</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_les_ordres_de_grandeur">3) Les ordres de grandeur</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="/images/BBL_coding-performance/bbl_coding-perf_orders-of-magnitude.png" alt="bbl coding perf orders of magnitude.png">
</div>
<div class="title">Figure 2. Ordres de grandeur</div>
</div>
<div class="paragraph">
<p>Concernant les <strong>latences mémoires</strong>, les ordres de grandeur sont particulièrement importants car :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ils permettent de <strong>catégoriser les problèmes rencontrés</strong>,<br>
&#8594; une latence inattendu de 30 ms n&#8217;est pas un problème de cache&#8230;&#8203;</p>
</li>
<li>
<p>et de <strong>bien choisir ses batailles</strong>.<br>
&#8594; passer 6 mois à améliorer les perfs de 5% alors que l&#8217;on sait que les serveurs vont être changés à ce moment (30% de gain de performance dans l&#8217;exemple donné par Jean-Philippe), n&#8217;est pas productif.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/BBL_coding-performance/bbl_coding-perf_orders-of-magnitude-tab.png" alt="bbl coding perf orders of magnitude tab.png">
</div>
<div class="title">Figure 3. Comparaison des latences mémoire</div>
</div>
<div class="paragraph">
<p>Suite à quoi, Jean-Philippe nous a "piégés" avec le problème suivant :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">{
	DBConnection dbConnection = DBConnection.getInstance();
	List&lt;Client&gt; activeClients = fetchActiveClients(dbConnection);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Question :</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Qu&#8217;est-ce qui peut poser problème ?"</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Réponse de la salle :</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>le singleton, le singleton, le singleton !!!!</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>(OK, j&#8217;exagère un petit peu&#8230;&#8203; emoji:wink[2x] )</p>
</div>
<div class="paragraph">
<p>Nous nous lançons dans une grande explication sur le singleton, le <strong>Double Check Locking</strong>, et&#8230;&#8203; et il n&#8217;y a <strong>pas d&#8217;index</strong> sur les tables clients&#8230;&#8203;<br>
Ce qui est bien plus pénalisant qu&#8217;un problème de singleton !</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Une fois de plus : choisissez bien vos batailles !</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Pour la peine, j&#8217;en profite pour redonner la solution du <strong>singleton en environnement multithreadé</strong> avec un <code>volatile</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/BBL_coding-performance/bbl_coding-perf_orders-of-magnitude-exemple.png" alt="bbl coding perf orders of magnitude exemple.png">
</div>
<div class="title">Figure 4. singleton multithread avec volatile</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_4_benchmark">4) Benchmark</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
L&#8217;avis de Jean-Philippe : il est très, <strong>très</strong>, <strong>TRES difficile</strong> de réaliser un benchmark correct.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Si vous devez en faire un, utilisez <strong>JMH</strong> (Java Microbenchmark Harness), et <strong>rien d&#8217;autre</strong> !</p>
</div>
<div class="paragraph">
<p>Et, même dans ce cas, soyez prudents !<br>
Le <strong>micro-benchmark</strong> implique un <strong>espace de travail TRES restreint</strong>, qui ne <strong>correspond PAS à la réalité</strong> !</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Conseil de Jean-Philippe : Dans la mesure du possible, préférez des macro-benchmarkd avec des <strong>données réelles</strong> (obtenir ces dernières n&#8217;est pas toujours évident).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_5_optimisation_pr_matur_e">5) Optimisation prématurée</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
Premature optimization is the root of all evil!
</blockquote>
<div class="attribution">
&#8212; Donald E. Knuth
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Le conseil à retenir absolument :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Measure, don&#8217;t guess!</p>
</li>
<li>
<p>Measure, don&#8217;t premature!</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>What is good performance engineer?</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>&#8594; C&#8217;est un ingénieur qui, avant toute autre chose, se demande si le temps qu&#8217;il va passer à son optimisation en vaut vraiment la peine. (<strong>équation économique</strong>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ressources">Ressources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Le Twitter "technique" de Jean-Philippe : @jpbempel</p>
</li>
<li>
<p>Son blog, orienté performance lui-aussi : <a href="http://jpbempel.blogspot.fr/" class="bare">http://jpbempel.blogspot.fr/</a></p>
</li>
<li>
<p><a href="https://channel9.msdn.com/Events/Build/2014/2-661">Modern C++: What you need to know</a> - Herb Sutter</p>
</li>
<li>
<p><a href="http://shipilev.net/blog/2014/safe-public-construction/">Safe Publication and Safe Initialization in Java</a> - Aleksey Shipilev</p>
</li>
<li>
<p><a href="http://openjdk.java.net/projects/code-tools/jmh/">JMH</a> (Java Microbenchmark Harness)</p>
</li>
<li>
<p><a href="http://mechanical-sympathy.blogspot.fr/">Mechanical sympathy</a> - Martin Thompson</p>
</li>
</ul>
</div>
</div>
</div>
                        <aside class="tags fi-pricetag-multiple">Posted on <a href="https://Ardemius.github.io/tag/BBL">BBL</a>, <a href="https://Ardemius.github.io/tag/performance"> performance</a>, <a href="https://Ardemius.github.io/tag/quality"> quality</a></aside>
            </section>
            <hr>
            <footer class="post-footer">

                <section class="share">
                    <h4>Liked this post ? Share it.</h4>
                    <a class="fi-social-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://Ardemius.github.io/2016/07/05/Compte-rendu-du-BBL-Coding-and-Performance-An-Initiatory-Journey.html"
                        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    </a>
                    <a class="fi-social-twitter" href="https://twitter.com/share?text=Compte%20rendu%20du%20BBL%20Coding%20%26%20Performance%2C%20An%20Initiatory%20Journey&amp;url=https://Ardemius.github.io/2016/07/05/Compte-rendu-du-BBL-Coding-and-Performance-An-Initiatory-Journey.html"
                        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    </a>
                    <a class="fi-social-google-plus" href="https://plus.google.com/share?url=https://Ardemius.github.io/2016/07/05/Compte-rendu-du-BBL-Coding-and-Performance-An-Initiatory-Journey.html"
                       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    </a>
                </section>

                <section class="author">
                    <header>
                        <span>About the author</span>
                    </header>
                    <section>
                        <h4>Thomas SCHWENDER</h4>
                        <img src="https://avatars3.githubusercontent.com/u/1645190?v=3">
                        <span>Paris, France</span>
                        
                    </section>
                    <footer>
                         <p></p>
                    </footer>
                </section>

        <div class="clearfix"></div>
                    <hr>

            </footer>

        <h3 class="title-disqus"><span class="fi-comments"></span>Discussions</h3>




    </article>

</main>

</div>

</div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();      
      </script>

    <!--[if lte IE 8]>
        <script type="text/javascript" src="//Ardemius.github.io/themes/ichi/assets/js/outdatedBrowser.min.js?v=1.0.0"></script>
    <![endif]-->
    <script type="text/javascript" src="//Ardemius.github.io/themes/ichi/assets/js/min/built.js?v=1.0.0"></script>

    <script>
      $(document).foundation();
    </script>

</body>
</html>
